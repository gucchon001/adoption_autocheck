# 求人応募者ステータス確認自動化システム仕様書

## 1. システム概要
求人サービスにおいて応募者のステータスを自動的に確認し、結果をスプレッドシートに記録およびSlack通知を行うシステム。

## 2. システム構成

### 2.1 ディレクトリ構造
- `tool.exe`: システム本体（実行ファイル）
- `main.py`: システムのソースコード
- `data.json`: Google Spreadsheet API認証用JSONファイル
- `setting.txt`: システム設定ファイル
- `log.txt`: 処理済み応募者ID記録用ログファイル
- `README.txt`: システム説明書

project_root/
├── src/
│ ├── main.py # メインスクリプト
│ └── modules/
│ ├── auth.py # 認証関連
│ ├── browser.py # ブラウザ操作
│ ├── scheduler.py # 実行スケジュール管理
│ ├── scraper.py # 応募者情報取得
│ ├── spreadsheet.py # スプレッドシート操作
│ └── notifier.py # Slack通知
├── config/
│ ├── setting.txt # 設定ファイル
│ └── data.json # Google API認証
├── logs/
│ └── log.txt # 処理ログ
└── dist/
└── tool.exe # 実行ファイル

### 2.2 外部連携
- Google Spreadsheet: 結果出力先
- Slack: 通知送信先
- 求人サービス: データ取得元

## 3. 機能仕様

### 3.1 基本フロー
1. Basic認証によるアクセス
2. サービスへのログイン
3. 指定時刻での実行待機
4. 応募者情報の検索
5. 応募者情報の確認・チェック
   - 採用ステータスの確認
   - 研修初日の確認
   - 在籍確認状況の確認
   - 採用お祝いの確認
   - 管理者メモの確認
6. 結果の記録（スプレッドシート）
7. 結果の通知（Slack）

### 3.2 チェック条件
以下の条件に合致する応募者を自動チェック:

1. 採用確定ケース:
   - ステータスが「採用」
   - 採用お祝い未送信
   - 管理者メモ未記入
   - 以下のいずれかに該当:
     a. 研修初日が「未定」で在籍確認未実施
     b. 研修初日が当月以降で在籍確認未実施
     c. 研修初日から1ヶ月経過し在籍確認済み

2. 不採用等確定ケース:
   - ステータスが「保留」「不合格」「連絡取れず」「辞退」「欠席」
   - 採用お祝い未送信
   - 管理者メモ未記入

### 3.3 設定項目
| 項目 | 説明 | 形式 |
|------|------|------|
| domain | サービスドメイン | 文字列（例：stgc.juku.st） |
| SpreadSheetKey | スプレッドシートID | 文字列 |
| webhook | Slack Webhook URL | URL文字列 |
| BasicId | Basic認証ID | 文字列 |
| BasicP | Basic認証パスワード | 文字列 |
| LoginId | サービスログインID | 文字列 |
| LoginPw | サービスログインパスワード | 文字列 |
| exec_time1 | 1回目実行時刻 | HH:MM形式 |
| exec_time2 | 2回目実行時刻 | HH:MM形式 |
| TEST | 提出期限指定 | boolean |

## 4. 技術仕様

### 4.1 使用技術
- Python 3.x
- Selenium WebDriver
- ChromeDriver
- gspread (Google Spreadsheet API)
- requests (Slack通知)

### 4.2 エラー処理
1. ネットワークエラー
   - 接続エラー時は10秒待機後リトライ
   - 3回リトライ後も失敗時はシステム停止

2. スプレッドシート更新エラー
   - 更新失敗時は10秒待機後1回リトライ
   - リトライ失敗時はエラーログを出力

### 4.3 セキュリティ
- Basic認証による保護
- 設定ファイルでの認証情報管理
- ChromeDriverのセキュリティ警告対応

## 5. 運用・保守

### 5.1 動作環境要件
- Windows OS
- Chrome ブラウザ
- 安定したインターネット接続
- スリープ設定の無効化

### 5.2 運用上の注意事項
1. システム稼働中の禁止事項:
   - システムコンソールの操作
   - 使用中のブラウザの操作
   - 設定ファイルの変更

2. 設定ファイル（setting.txt）の編集:
   - 「=」以降の値のみ変更可能
   - 空白・改行の追加禁止
   - 形式を厳密に守る必要あり

## 6. サポート体制
- 不具合報告: ココナラDM
- 技術サポート: 開発者への直接連絡 